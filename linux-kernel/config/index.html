
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.2.5">
    
    
      
        <title>Drivers en Linux. Preparación del entorno de trabajo - BEE Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#drivers-en-linux-preparacion-del-entorno-de-trabajo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BEE Docs" class="md-header__button md-logo" aria-label="BEE Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BEE Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Drivers en Linux. Preparación del entorno de trabajo
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BEE Docs" class="md-nav__button md-logo" aria-label="BEE Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    BEE Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Documentación Técnica
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Documentación Técnica" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Documentación Técnica
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Placa de expansión BEE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Prácticas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prácticas" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Prácticas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gpio_linux/" class="md-nav__link">
        Control GPIO en Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pwm_linux/" class="md-nav__link">
        Control PWM en Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spi_linux/" class="md-nav__link">
        Control de dispositivos SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../i2c_linux/" class="md-nav__link">
        Control de dispositivos I2C
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control_servomotores/" class="md-nav__link">
        Control de servomotores con PWM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../robotica/" class="md-nav__link">
        Prácticas de Robótica
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Drivers en Linux. Preparación del entorno de trabajo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Drivers en Linux. Preparación del entorno de trabajo
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuracion-hardware-de-placa-de-entrada-salida-bee-v20-para-realizacion-de-practicas" class="md-nav__link">
    Configuración hardware de placa de entrada-salida ("Bee v2.0") para realización de prácticas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-inicial-de-la-maquina-virtual-y-de-la-red-interna" class="md-nav__link">
    Configuración inicial de la máquina virtual y de la red interna
  </a>
  
    <nav class="md-nav" aria-label="Configuración inicial de la máquina virtual y de la red interna">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conexion-de-dispositivos-usb-a-la-maquina-virtual" class="md-nav__link">
    Conexión de dispositivos USB a la máquina virtual
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#primer-arranque-de-la-raspberry-pi" class="md-nav__link">
    Primer arranque de la Raspberry Pi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prueba-de-conexion-por-ssh-a-la-raspberry-pi-desde-la-maquina-virtual" class="md-nav__link">
    Prueba de conexión por SSH a la Raspberry Pi desde la máquina virtual
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprobacion-del-funcionamiento-de-la-placa-de-es-y-de-su-configuracion" class="md-nav__link">
    Comprobación del funcionamiento de la placa de E/S y de su configuración
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analisis-de-alternativas-para-desarrollo-en-la-raspberry-pi-desde-la-maquina-virtual-configuracion-de-vscode" class="md-nav__link">
    Análisis de alternativas para desarrollo en la Raspberry Pi desde la máquina virtual. Configuración de VSCode.
  </a>
  
    <nav class="md-nav" aria-label="Análisis de alternativas para desarrollo en la Raspberry Pi desde la máquina virtual. Configuración de VSCode.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opcion-1-ejecucion-del-editor-en-la-propia-placa" class="md-nav__link">
    Opción 1: Ejecución del editor en la propia placa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opcion-2-sshfs-y-edicion-de-ficheros-desde-el-host" class="md-nav__link">
    Opción 2: SSHFS y edición de ficheros desde el host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opcion-3-uso-de-extension-remote-de-vscode-para-trabajar-con-raspberry-pi-de-forma-transparente" class="md-nav__link">
    Opción 3: Uso de extensión Remote de VSCode para trabajar con Raspberry Pi de forma transparente
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../drivers/" class="md-nav__link">
        Drivers en Linux. Aspectos básicos y GPIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sincronizacion/" class="md-nav__link">
        Drivers en Linux. Sincronización en el kernel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interrupt-timers-pwm/" class="md-nav__link">
        Drivers en Linux. Gestión de interrupciones, temporizadores, y trabajos diferidos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="drivers-en-linux-preparacion-del-entorno-de-trabajo">Drivers en Linux. Preparación del entorno de trabajo<a class="headerlink" href="#drivers-en-linux-preparacion-del-entorno-de-trabajo" title="Permanent link">&para;</a></h1>
<p>Esta breve guía describe el procedimiento de configuración del sistema formado por la Raspberry Pi (en su variante 3B+ o 4) y la placa de entrada salida Bee v2.0, para la realización de prácticas sobre desarrollo de Drivers en Linux. Esencialmente, para preparar este entorno de prácticas deben realizarse los siguientes pasos:</p>
<ol>
<li>Configuración hardware de placa de entrada-salida ("Bee v2.0") para realización de prácticas</li>
<li>Configuración inicial de la máquina virtual y de la red interna para conexión con la Raspberry Pi</li>
<li>Arranque por primera vez de la Raspberry Pi usando imagen <em>custom</em> preparada para las prácticas</li>
<li>Prueba de conexión por SSH a la Raspberry Pi desde la máquina virtual</li>
<li>Comprobación del funcionamiento de la placa de E/S y de su configuración</li>
<li>Análisis de alternativas para desarrollo en la Raspberry Pi desde la máquina virtual. Configuración de VSCode.</li>
</ol>
<p>Además del equipo con la máquina virtual instalada, y de la Raspberry Pi conectada a la placa de E/S, se requiere disponer del siguiente material para la realización de los distintos pasos:</p>
<ul>
<li>
<p><strong>Scripts de comprobación de conexiones de la placa Bee</strong>:  Se encuentran en el directorio <code>TestBee</code> de los <a href="/linux-kernel/src/drivers.tgz">ficheros de ejemplo proporcionados con la primera práctica de drivers</a>.</p>
</li>
<li>
<p><strong>Tarjeta SD de al menos 16GB</strong>: En esta tarjeta se ha de instalar una imagen <em>custom</em> de Raspberry Pi OS. El fichero de imagen (<code>raspberry-pi-os_030422.img</code>) puede descargarse usando <a href="https://drive.google.com/file/d/1xv1LIroXElqzWMXwHLi-MlGTQ3s2ul50/view?usp=sharing">este enlace de Google Drive</a>. Para la instalación/restauración de la imagen puede emplearse  la aplicación gratuita multiplataforma <strong>balenaEtcher</strong> que puede descargarse <a href="https://www.balena.io/etcher/">aquí</a>. La instalación de la imagen es un proceso muy sencillo. Basta seleccionar el fichero de imagen descargado previamente en nuestro equipo (fichero <code>raspberry-pi-os_030422.img</code> ) , escoger la unidad de la tarjeta SD de 16GB donde instalar la imagen (accesible mediante un lector de tarjetas SD), y finalmente hacer clic en Flash.</p>
</li>
<li>
<p><strong>Cable USB TTL</strong></p>
</li>
<li>
<p><strong>Interfaz USB Ethernet</strong></p>
</li>
<li>
<p><strong>Cable Ethernet</strong></p>
</li>
<li>
<p><strong>7 cables dupont hembra-hembra</strong></p>
</li>
<li>
<p><strong>Dos <em>jumpers</em></strong> (o en su defecto dos cables dupont hembra-hembra adicionales para interconectar 4 pines de la placa Bee v2.0)</p>
</li>
</ul>
<h2 id="configuracion-hardware-de-placa-de-entrada-salida-bee-v20-para-realizacion-de-practicas">Configuración hardware de placa de entrada-salida ("Bee v2.0") para realización de prácticas<a class="headerlink" href="#configuracion-hardware-de-placa-de-entrada-salida-bee-v20-para-realizacion-de-practicas" title="Permanent link">&para;</a></h2>
<p>La placa de E/S Bee v2.0 que se utilizará en las prácticas de desarrollo de drivers consta de una serie de circuitos desacoplados para la gestión de distintos dispositivos como LEDs, pulsadores, un zumbador (<em>buzzer</em>) pasivo, etc. Antes de proceder a arrancar la Raspberry Pi usando la imagen del sistema operativo instalado en la tarjeta SD es preciso realizar distintas conexiones entre pines específicos de la placa (GPIOs) y los pines de entrada o salida de los circuitos que controlan los distintos dispositivos a utilizar. Asimismo, es necesario conectar el cable USB TTL para poder visualizar la salida del puerto serie de la placa desde la máquina virtual de Debian.</p>
<p>La siguiente figura muestra los módulos de pines (J3, J4, J5, J6, J13 y J17) donde se realizarán las conexiones necesarias usando 7 cables dupont hembra-hembra y 2 <em>jumpers</em> (o, dos cables dupont extra, si no se dispone de <em>jumpers</em>).</p>
<p><img alt="" src="../img/placa_main_anot.jpg" /></p>
<p>El siguiente video ilustra cómo realizar las interconexiones de los pines que se requieren para las prácticas:</p>
<iframe src="https://drive.google.com/file/d/15ktZ1ywU0-Q7tUWz2CO8PlWbR1fuHqgf/preview" allowfullscreen="true" width="700" height="394"></iframe>

<h2 id="configuracion-inicial-de-la-maquina-virtual-y-de-la-red-interna">Configuración inicial de la máquina virtual y de la red interna<a class="headerlink" href="#configuracion-inicial-de-la-maquina-virtual-y-de-la-red-interna" title="Permanent link">&para;</a></h2>
<p>En este paso procederemos a arrancar la máquina virtual de Debian VMWare, y realizaremos la configuración mínima necesaria para poder conectarnos a la Raspberry Pi desde la máquina virtual de distintas formas.</p>
<p>Tras finalizar el proceso de arranque iniciaremos sesión con el usuario <code>kernel</code> y contraseña <code>kernel</code>. </p>
<p>Recordad que la cuenta de usuario tiene "permisos de <code>sudo</code>". Para ejecutar un comando como <em>root</em>, cuando sea preciso, se ha de hacer lo siguiente:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>&lt;comando&gt;
</span></code></pre></div>
<p>y teclear la contraseña del usuario en cuestión (no la de <em>root</em>) cuando la solicite.</p>
<p>Para abrir un <em>shell</em> de root, debemos usar el siguiente comando:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>-i
</span></code></pre></div>
<h3 id="conexion-de-dispositivos-usb-a-la-maquina-virtual">Conexión de dispositivos USB a la máquina virtual<a class="headerlink" href="#conexion-de-dispositivos-usb-a-la-maquina-virtual" title="Permanent link">&para;</a></h3>
<p>Para poder acceder vía Ethernet y vía puerto serie a la Raspberry Pi desde la máquina virtual, es preciso ahora conectar la interfaz Ethernet USB y el cable USB TTL a nuestro equipo. La interfaz Ethernet debe estar conectada usando un cable Ethernet a la Raspberry Pi, y el cable USB TTL también debe estar conectado a la placa tal y como se mostró en el video descriptivo.</p>
<p>Al conectar ambos dispositivos USB a nuestro equipo, los dispositivos deberían listarse correctamente en la entrada de menú "USB &amp; Bluetooth" de VMWare, tal y como se muestra en la siguiente imagen:</p>
<p><img alt="configuracion_usb1" src="../img/configuracion_usb1.png" /></p>
<p>En la captura de pantalla, la interfaz Ethernet conectada figura como "ASIX AX88772B" (el modelo de la interfaz proporcionado con el material de laboratorios podría ser diferente), y el cable USB TTL como "Future Devices TTL232R-3V3". Para que la máquina virtual tenga el control de ambos dispositivos es necesario hacer clic en la entrada de menú con etiqueta "Connect ..." para los dos dispositivos. Al hacer esto, el menú "USB &amp; Bluetooth" debería mostrar ahora la etiqueta "Disconnect ..." para ambos dispositivos:</p>
<p><img alt="configuracion_usb2" src="../img/configuracion_usb2.png" /></p>
<p>Procederemos ahora a comprobar si el dispositivo <code>/dev/ttyUSB0</code> está presente, lo cual indicará que el cable USB TTL ha sido reconocido adecuadamente por el sistema Debian. Para ello, abriremos una ventana de terminal dentro de la máquina virtual y ejecutaremos el siguiente comando:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>kernel@debian:~$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>/dev/ttyUSB0
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>crw-rw----<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>dialout<span class="w"> </span><span class="m">188</span>,<span class="w"> </span><span class="m">0</span><span class="w"> </span>abr<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">18</span>:47<span class="w"> </span>/dev/ttyUSB0
</span></code></pre></div>
<p>Para verificar que la interfaz de red USB se ha reconocido correctamente ejecutaremos el comando <code>ip a</code> , que debería listar tres interfaces de red: loopback (<code>lo</code>), la interfaz ethernet de la propia máquina virtual (<code>ens33</code>) y, en último lugar, la interfaz USB Ethernet:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>kernel@debian:~$<span class="w"> </span>ip<span class="w"> </span>a
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="m">1</span>:<span class="w"> </span>lo:<span class="w"> </span>&lt;LOOPBACK,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">65536</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>state<span class="w"> </span>UNKNOWN<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span>link/loopback<span class="w"> </span><span class="m">00</span>:00:00:00:00:00<span class="w"> </span>brd<span class="w"> </span><span class="m">00</span>:00:00:00:00:00
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span>inet<span class="w"> </span><span class="m">127</span>.0.0.1/8<span class="w"> </span>scope<span class="w"> </span>host<span class="w"> </span>lo
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">       </span>valid_lft<span class="w"> </span>forever<span class="w"> </span>preferred_lft<span class="w"> </span>forever
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span>inet6<span class="w"> </span>::1/128<span class="w"> </span>scope<span class="w"> </span>host<span class="w"> </span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">       </span>valid_lft<span class="w"> </span>forever<span class="w"> </span>preferred_lft<span class="w"> </span>forever
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="m">2</span>:<span class="w"> </span>ens33:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>pfifo_fast<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span>link/ether<span class="w"> </span><span class="m">00</span>:0c:29:c4:71:56<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">    </span>inet<span class="w"> </span><span class="m">192</span>.168.127.131/24<span class="w"> </span>brd<span class="w"> </span><span class="m">192</span>.168.127.255<span class="w"> </span>scope<span class="w"> </span>global<span class="w"> </span>dynamic<span class="w"> </span>noprefixroute<span class="w"> </span>ens33
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">       </span>valid_lft<span class="w"> </span>1624sec<span class="w"> </span>preferred_lft<span class="w"> </span>1624sec
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span>inet6<span class="w"> </span>fe80::20c:29ff:fec4:7156/64<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>noprefixroute<span class="w"> </span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">       </span>valid_lft<span class="w"> </span>forever<span class="w"> </span>preferred_lft<span class="w"> </span>forever
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="m">3</span>:<span class="w"> </span>enx00001b3c0049:<span class="w"> </span>&lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>pfifo_fast<span class="w"> </span>state<span class="w"> </span>DOWN<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span>link/ether<span class="w"> </span><span class="m">00</span>:00:1b:3c:00:49<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
</span></code></pre></div>
<p>Llegados a este punto es crucial anotar el nombre asignado por Linux para la interfaz USB Ethernet conectada a nuestro equipo, ya que este nombre deberá almacenarse en dos ficheros que editaremos a continuación. Esto es preciso para configurar correctamente la red interna, por donde estableceremos comunicación con la Raspberry Pi. En particular, es preciso realizar lo siguiente:</p>
<ul>
<li>Reemplazar los ficheros <code>/usr/local/bin/setup-network.sh</code> y <code>/etc/hosts</code> con la versión de los mismos que se encuentra <a href="https://jcsaezal.github.io/lin-ucm-docs/code/fixed-files.tgz">aquí</a>. Para ello se pueden ejecutar los siguientes comandos:</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Crear directorio temporal para almacenar los ficheros</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>kernel@debian:~$<span class="w"> </span>mkdir<span class="w"> </span>/tmp/new
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>kernel@debian:~$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/tmp/new
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c1"># Descargar ficheros en directorio temporal con wget</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>kernel@debian:/tmp/new$<span class="w"> </span>wget<span class="w"> </span>https://jcsaezal.github.io/lin-ucm-docs/code/fixed-files.tgz
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w"> </span>wget<span class="w"> </span>https://jcsaezal.github.io/lin-ucm-docs/code/fixed-files.tgz
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>--2024-10-25<span class="w"> </span><span class="m">16</span>:08:19--<span class="w">  </span>https://jcsaezal.github.io/lin-ucm-docs/code/fixed-files.tgz
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>Resolviendo<span class="w"> </span>jcsaezal.github.io<span class="w"> </span><span class="o">(</span>jcsaezal.github.io<span class="o">)</span>...<span class="w"> </span><span class="m">185</span>.199.111.153,<span class="w"> </span><span class="m">185</span>.199.109.153,<span class="w"> </span><span class="m">185</span>.199.108.153,<span class="w"> </span>...
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>Conectando<span class="w"> </span>con<span class="w"> </span>jcsaezal.github.io<span class="w"> </span><span class="o">(</span>jcsaezal.github.io<span class="o">)[</span><span class="m">185</span>.199.111.153<span class="o">]</span>:443...<span class="w"> </span>conectado.
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>Petición<span class="w"> </span>HTTP<span class="w"> </span>enviada,<span class="w"> </span>esperando<span class="w"> </span>respuesta...<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>Longitud:<span class="w"> </span><span class="m">1293</span><span class="w"> </span><span class="o">(</span><span class="m">1</span>,3K<span class="o">)</span><span class="w"> </span><span class="o">[</span>application/octet-stream<span class="o">]</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>Grabando<span class="w"> </span>a:<span class="w"> </span>«fixed-files.tgz»
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>fixed-files.tgz<span class="w">     </span><span class="m">100</span>%<span class="o">[===================</span>&gt;<span class="o">]</span><span class="w">   </span><span class="m">1</span>,26K<span class="w">  </span>--.-KB/s<span class="w">    </span>en<span class="w"> </span>0s<span class="w">      </span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="m">2024</span>-10-25<span class="w"> </span><span class="m">16</span>:08:19<span class="w"> </span><span class="o">(</span><span class="m">97</span>,2<span class="w"> </span>MB/s<span class="o">)</span><span class="w"> </span>-<span class="w"> </span>«fixed-files.tgz»<span class="w"> </span>guardado<span class="w"> </span><span class="o">[</span><span class="m">1293</span>/1293<span class="o">]</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>kernel@debian:/tmp/new$<span class="w"> </span>tar<span class="w"> </span>xzvf<span class="w"> </span>fixed-files.tgz
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>./._copy_files.sh
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>copy_files.sh
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>./._hosts
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>hosts
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>./._setup-network.sh
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>setup-network.sh
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="c1"># Reemplazar ficheros necesarios usando el script que se proporciona (Introducir contraseña usuario kernel si la solicita)</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>kernel@debian:/tmp/new$<span class="w"> </span>./copy_files.sh
</span></code></pre></div>
<ul>
<li>
<p>Efectuar las siguientes modificaciones en el  fichero <code>/etc/network/interfaces</code> como <em>root</em> (p.ej.: <code>sudo nano /etc/network/interfaces</code> )</p>
</li>
<li>
<p>Descomentar las 4 últimas líneas del fichero, eliminando el símbolo "#" al principio de las 4 líneas:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">#auto enx00001b3c0049</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1">#iface enx00001b3c0049 inet static</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1">#address 192.168.2.1</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1">#netmask 255.255.255.0</span>
</span></code></pre></div>
</li>
<li>
<p>Tras descomentar estas líneas, se ha de establecer el nombre asignado a la interfaz USB Ethernet en nuestro sistema en las dos primeras líneas de ese fragmento de texto. Así, por ejemplo, si el nombre de la interfaz USB Ethernet mostrado por <code>ip a</code> fuese "enx00001b3c7740", las últimas 4 líneas del fichero <code>/etc/network/interfaces</code> deberían ser las siguientes:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>auto enx00001b3c7740
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>iface enx00001b3c7740 inet static
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>address 192.168.2.1
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>netmask 255.255.255.0
</span></code></pre></div>
</li>
<li>
<p>Editar el script <code>/usr/local/bin/setup-network.sh</code> como <em>root</em> (p.ej.: <code>sudo nano /usr/local/bin/setup-network.sh</code> ) </p>
</li>
<li>
<p>Modificar la primera línea del fichero (definición de variable <code>ifname</code>) para establecer correctamente el nombre de la interfaz USB Ethernet de nuestro equipo. Así por ejemplo, si  el nombre de la interfaz USB Ethernet fuese "enx00001b3c7740", el contenido del fichero <code>/usr/local/bin/setup-network.sh</code> debería quedar de la siguiente forma:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nv">ifname</span><span class="o">=</span><span class="s2">&quot;enx00001b3c7740&quot;</span><span class="w">  </span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>service<span class="w"> </span>networking<span class="w"> </span>restart
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>iptables<span class="w"> </span>-A<span class="w"> </span>FORWARD<span class="w"> </span>--in-interface<span class="w"> </span><span class="si">${</span><span class="nv">ifname</span><span class="si">}</span><span class="w">  </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>iptables<span class="w"> </span>--table<span class="w"> </span>nat<span class="w"> </span>-A<span class="w"> </span>POSTROUTING<span class="w"> </span>--out-interface<span class="w"> </span>ens33<span class="w"> </span>-j<span class="w"> </span>MASQUERADE
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>iptables<span class="w"> </span>-I<span class="w"> </span>DOCKER-USER<span class="w"> </span>-o<span class="w"> </span><span class="si">${</span><span class="nv">ifname</span><span class="si">}</span><span class="w"> </span>-i<span class="w"> </span>ens33<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>sysctl<span class="w"> </span>-w<span class="w"> </span>net.ipv4.ip_forward<span class="o">=</span><span class="m">1</span>
</span></code></pre></div>
</li>
</ul>
<p>Tras llevar a cabo estas modificaciones en los ficheros, procederemos a configurar la red interna ejecutando el script <code>setup-network.sh</code> con <code>sudo</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>kernel@debian:~$<span class="w"> </span>sudo<span class="w"> </span>setup-network.sh
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>net.ipv4.ip_forward<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
</span></code></pre></div>
<p><strong>Nota importante</strong>: Para establecer correctamente la configuración de la red interna, este script deberá ejecutarse manualmente siempre que se reinicie la máquina virtual (MV) de Debian, y siempre asegurándonos que la interfaz USB Ethernet está conectada a la MV.</p>
<h2 id="primer-arranque-de-la-raspberry-pi">Primer arranque de la Raspberry Pi<a class="headerlink" href="#primer-arranque-de-la-raspberry-pi" title="Permanent link">&para;</a></h2>
<p>Si se han realizado correctamente todos los pasos hasta este punto, la máquina virtual debería está correctamente configurada, incluyendo la red interna para conexión con la Raspberry Pi. Procederemos entonces a iniciar una sesión serie con la Raspberry Pi (no arrancar aún) desde la máquina virtual, usando el programa <code>minicom</code> de la siguiente forma:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>minicom<span class="w"> </span>ttyUSB0<span class="w"> </span>
</span></code></pre></div>
<p>Esto abrirá la sesión serie de minicom:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>Welcome<span class="w"> </span>to<span class="w"> </span>minicom<span class="w"> </span><span class="m">2</span>.7.1
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>OPCIONES:<span class="w"> </span>I18n<span class="w"> </span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>Compilado<span class="w"> </span>en<span class="w"> </span>May<span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">2018</span>,<span class="w"> </span><span class="m">08</span>:02:47.
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>Port<span class="w"> </span>/dev/ttyUSB0,<span class="w"> </span><span class="m">18</span>:47:08
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>Presione<span class="w"> </span>CTRL-A<span class="w"> </span>Z<span class="w"> </span>para<span class="w"> </span>obtener<span class="w"> </span>ayuda<span class="w"> </span>sobre<span class="w"> </span>teclas<span class="w"> </span>especiales
</span></code></pre></div>
<p>En este preciso instante, arrancaremos la Raspberry Pi, y visualizaremos el proceso de arranque por la sesión serie de minicom. Nótese que el primer arranque de la placa puede tardar más de lo habitual (algunos minutos), ya que el sistema de ficheros de la partición raíz en la tarjeta SD está configurado para expandirse durante este primer arranque. Acabado el proceso de arranque, se mostrará el <em>prompt</em> de login a través del puerto serie:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>triggerhappy<span class="w"> </span>global<span class="w"> </span>hotkey<span class="w"> </span>daemon.
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Finished<span class="w"> </span>Check<span class="w"> </span><span class="k">for</span><span class="w"> </span>glamor.
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Finished<span class="w"> </span>Check<span class="w"> </span><span class="k">for</span><span class="w"> </span>v3d<span class="w"> </span>driver.
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Finished<span class="w"> </span>Remove<span class="w"> </span>Stale<span class="w"> </span>Onli…ext4<span class="w"> </span>Metadata<span class="w"> </span>Check<span class="w"> </span>Snapshots.
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>System<span class="w"> </span>Logging<span class="w"> </span>Service.
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Finished<span class="w"> </span>dphys-swapfile<span class="w"> </span>-<span class="w"> </span>…mount,<span class="w"> </span>and<span class="w"> </span>delete<span class="w"> </span>a<span class="w"> </span>swap<span class="w"> </span>file.
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>LSB:<span class="w"> </span>rng-tools<span class="w"> </span><span class="o">(</span>Debian<span class="w"> </span>variant<span class="o">)</span>.
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>User<span class="w"> </span>Login<span class="w"> </span>Management.
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>Avahi<span class="w"> </span>mDNS/DNS-SD<span class="w"> </span>Stack.
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>WPA<span class="w"> </span>supplicant.
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">           </span>Starting<span class="w"> </span>Authorization<span class="w"> </span>Manager...
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Finished<span class="w"> </span>Raise<span class="w"> </span>network<span class="w"> </span>interfaces.
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Reached<span class="w"> </span>target<span class="w"> </span>Network.
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">           </span>Starting<span class="w"> </span>CUPS<span class="w"> </span>Scheduler...
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">           </span>Starting<span class="w"> </span>/etc/rc.local<span class="w"> </span>Compatibility...
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">           </span>Starting<span class="w"> </span>OpenBSD<span class="w"> </span>Secure<span class="w"> </span>Shell<span class="w"> </span>server...
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">           </span>Starting<span class="w"> </span>Permit<span class="w"> </span>User<span class="w"> </span>Sessions...
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">  </span>My<span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span>is<span class="w"> </span><span class="m">192</span>.168.2.20<span class="w"> </span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>VNC<span class="w"> </span>Server<span class="w"> </span><span class="k">in</span><span class="w"> </span>Service<span class="w"> </span>Mode<span class="w"> </span>daemon.
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>/etc/rc.local<span class="w"> </span>Compatibility.
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Finished<span class="w"> </span>Permit<span class="w"> </span>User<span class="w"> </span>Sessions.
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">           </span>Starting<span class="w"> </span>Light<span class="w"> </span>Display<span class="w"> </span>Manager...
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">           </span>Starting<span class="w"> </span>Hold<span class="w"> </span><span class="k">until</span><span class="w"> </span>boot<span class="w"> </span>process<span class="w"> </span>finishes<span class="w"> </span>up...
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>LSB:<span class="w"> </span>Switch<span class="w"> </span>to<span class="w"> </span>ond…<span class="o">(</span>unless<span class="w"> </span><span class="nb">shift</span><span class="w"> </span>key<span class="w"> </span>is<span class="w"> </span>pressed<span class="o">)</span>.
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>Authorization<span class="w"> </span>Manager.
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">  </span><span class="o">[</span><span class="w">  </span>OK<span class="w">  </span><span class="o">]</span><span class="w"> </span>Started<span class="w"> </span>OpenBSD<span class="w"> </span>Secure<span class="w"> </span>Shell<span class="w"> </span>server.
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">  </span>Raspbian<span class="w"> </span>GNU/Linux<span class="w"> </span><span class="m">11</span><span class="w"> </span>raspberrypi<span class="w"> </span>ttyS0
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="w">  </span>raspberrypi<span class="w"> </span>login:<span class="w"> </span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">  </span>CTRL-A<span class="w"> </span>Z<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">115200</span><span class="w"> </span>8N1<span class="w"> </span><span class="p">|</span><span class="w"> </span>NOR<span class="w"> </span><span class="p">|</span><span class="w"> </span>Minicom<span class="w"> </span><span class="m">2</span>.7.1<span class="w"> </span><span class="p">|</span><span class="w"> </span>VT102<span class="w"> </span><span class="p">|</span><span class="w"> </span>Desconectado<span class="w"> </span><span class="p">|</span><span class="w"> </span>ttyUSB0<span class="w">  </span>
</span></code></pre></div>
<p>Opcionalmente en este paso se puede realizar login (si se desea) a través del puerto serie utlizando las siguientes credenciales:</p>
<ul>
<li>nombre de usuario: <code>pi</code></li>
<li>Contraseña: <code>raspberry</code></li>
</ul>
<h2 id="prueba-de-conexion-por-ssh-a-la-raspberry-pi-desde-la-maquina-virtual">Prueba de conexión por SSH a la Raspberry Pi desde la máquina virtual<a class="headerlink" href="#prueba-de-conexion-por-ssh-a-la-raspberry-pi-desde-la-maquina-virtual" title="Permanent link">&para;</a></h2>
<p>Considerando que la configuración de red se ha realizado correctamente, la Raspberry Pi debería ser accesible por SSH desde la máquina virtual utilizando la dirección IP estática 192.198.2.20, o alternativamente el nombre de host <code>pi</code>, que figura en el fichero <code>/etc/hosts</code> de la máquina virtual. A continuación se muestra el resultado de acceder por SSH a la Raspberry Pi la primera vez desde la máquina virtual (usuario: "pi", contraseña: "raspberry"):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>kernel@debian:~$<span class="w"> </span>ssh<span class="w"> </span>pi@pi
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>The<span class="w"> </span>authenticity<span class="w"> </span>of<span class="w"> </span>host<span class="w"> </span><span class="s1">&#39;pi (192.168.2.20)&#39;</span><span class="w"> </span>can<span class="s1">&#39;t be established.</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="s1">ECDSA key fingerprint is SHA256:w+zPKbk0eA66xKatEQMe/Hr70SST88LrvHlsF7CfiQE.</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="s1">Are you sure you want to continue connecting (yes/no)? yes</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="s1">Warning: Permanently added &#39;</span>pi,192.168.2.20<span class="s1">&#39; (ECDSA) to the list of known hosts.</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="s1">pi@pi&#39;</span>s<span class="w"> </span>password:<span class="w"> </span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>Linux<span class="w"> </span>raspberrypi<span class="w"> </span><span class="m">5</span>.10.92-v7+<span class="w"> </span><span class="c1">#1514 SMP Mon Jan 17 17:36:39 GMT 2022 armv7l</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>The<span class="w"> </span>programs<span class="w"> </span>included<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>Debian<span class="w"> </span>GNU/Linux<span class="w"> </span>system<span class="w"> </span>are<span class="w"> </span>free<span class="w"> </span>software<span class="p">;</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>the<span class="w"> </span>exact<span class="w"> </span>distribution<span class="w"> </span>terms<span class="w"> </span><span class="k">for</span><span class="w"> </span>each<span class="w"> </span>program<span class="w"> </span>are<span class="w"> </span>described<span class="w"> </span><span class="k">in</span><span class="w"> </span>the
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>individual<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>/usr/share/doc/*/copyright.
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>Debian<span class="w"> </span>GNU/Linux<span class="w"> </span>comes<span class="w"> </span>with<span class="w"> </span>ABSOLUTELY<span class="w"> </span>NO<span class="w"> </span>WARRANTY,<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>extent
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>permitted<span class="w"> </span>by<span class="w"> </span>applicable<span class="w"> </span>law.
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>Last<span class="w"> </span>login:<span class="w"> </span>Sun<span class="w"> </span>Oct<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">21</span>:15:07<span class="w"> </span><span class="m">2022</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>SSH<span class="w"> </span>is<span class="w"> </span>enabled<span class="w"> </span>and<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;pi&#39;</span><span class="w"> </span>user<span class="w"> </span>has<span class="w"> </span>not<span class="w"> </span>been<span class="w"> </span>changed.
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>security<span class="w"> </span>risk<span class="w"> </span>-<span class="w"> </span>please<span class="w"> </span>login<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;pi&#39;</span><span class="w"> </span>user<span class="w"> </span>and<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;passwd&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>password.
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>Wi-Fi<span class="w"> </span>is<span class="w"> </span>currently<span class="w"> </span>blocked<span class="w"> </span>by<span class="w"> </span>rfkill.
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>Use<span class="w"> </span>raspi-config<span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>the<span class="w"> </span>country<span class="w"> </span>before<span class="w"> </span>use.
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>pi@raspberrypi:~<span class="w"> </span>$<span class="w"> </span>
</span></code></pre></div>
<p>Para garantizar que la configuración de red es completamente funcional, comprobaremos que la Raspberry Pi tiene acceso a Internet, ejecutando el siguiente comando (a cancelar manualmente con CTRL+C):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="w">  </span>pi@raspberrypi:~<span class="w"> </span>$<span class="w"> </span>ping<span class="w"> </span>www.google.es
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span>PING<span class="w"> </span>www.google.es<span class="w"> </span><span class="o">(</span><span class="m">142</span>.250.201.67<span class="o">)</span><span class="w"> </span><span class="m">56</span><span class="o">(</span><span class="m">84</span><span class="o">)</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data.
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>mad07s25-in-f3.1e100.net<span class="w"> </span><span class="o">(</span><span class="m">142</span>.250.201.67<span class="o">)</span>:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">127</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">7</span>.62<span class="w"> </span>ms
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span><span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>mad07s25-in-f3.1e100.net<span class="w"> </span><span class="o">(</span><span class="m">142</span>.250.201.67<span class="o">)</span>:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">127</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">8</span>.10<span class="w"> </span>ms
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">  </span><span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>mad07s25-in-f3.1e100.net<span class="w"> </span><span class="o">(</span><span class="m">142</span>.250.201.67<span class="o">)</span>:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">127</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">9</span>.16<span class="w"> </span>ms
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">  </span><span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>mad07s25-in-f3.1e100.net<span class="w"> </span><span class="o">(</span><span class="m">142</span>.250.201.67<span class="o">)</span>:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">127</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">11</span>.0<span class="w"> </span>ms
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">  </span><span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span>mad07s25-in-f3.1e100.net<span class="w"> </span><span class="o">(</span><span class="m">142</span>.250.201.67<span class="o">)</span>:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">127</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">12</span>.1<span class="w"> </span>ms
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">  </span>^C
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">  </span>---<span class="w"> </span>www.google.es<span class="w"> </span>ping<span class="w"> </span>statistics<span class="w"> </span>---
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">  </span><span class="m">6</span><span class="w"> </span>packets<span class="w"> </span>transmitted,<span class="w"> </span><span class="m">5</span><span class="w"> </span>received,<span class="w"> </span><span class="m">16</span>.6667%<span class="w"> </span>packet<span class="w"> </span>loss,<span class="w"> </span><span class="nb">time</span><span class="w"> </span>5051ms
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">  </span>rtt<span class="w"> </span>min/avg/max/mdev<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span>.615/9.594/12.143/1.713<span class="w"> </span>ms
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">  </span>pi@raspberrypi:~<span class="w"> </span>$<span class="w"> </span>
</span></code></pre></div>
<h2 id="comprobacion-del-funcionamiento-de-la-placa-de-es-y-de-su-configuracion">Comprobación del funcionamiento de la placa de E/S y de su configuración<a class="headerlink" href="#comprobacion-del-funcionamiento-de-la-placa-de-es-y-de-su-configuracion" title="Permanent link">&para;</a></h2>
<p>Concluiremos la preparación del entorno de trabajo comprobando que las conexiones realizadas en la placa Bee v2.0 (punto 1 de esta guía), son correctas, y que por tanto,  los dispositivos correspondientes que se usarán en las prácticas (ver imagen a continuación) son completamente funcionales. </p>
<p><img alt="placa_main_comp" src="../img/placa_main_comp.png" /></p>
<p>Para realizar las comprobaciones pertinentes es preciso haber descargado primero los  <a href="/linux-kernel/src/drivers.tgz">ficheros de la primera práctica sobre <em>drivers</em></a>. Los comandos que se muestran a continuación asumen que el fichero TAR.GZ correspondiente se ha extraído en el directorio HOME del usuario <code>kernel</code>, por lo que existirá un directorio <code>TestBee</code> en su interior, donde podrán encontrarse cuatro scripts:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>pi@raspberrypi:~<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>TestBee/
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>pi@raspberrypi:~/TestBee<span class="w"> </span>$<span class="w"> </span>ls
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>7sdisplay_test.py<span class="w">       </span>button_test.py<span class="w">  </span>buzzer_test.sh<span class="w">  </span>leds_test.py
</span></code></pre></div>
<p>Estos scripts permiten controlar el estado del display 7 segmentos de la placa, modificar el estado de los LEDS D1-D3, reproducir notas musicales con el buzzer pasivo, y comprobar si el pulsador SW1 está o no pulsado, todo ello desde espacio de usuario. Cabe destacar que en las prácticas de este curso nos centraremos en el acceso a estos dispositivos desde el kernel Linux. Por lo tanto, se deja como ejercicio el estudio del código de los scripts proporcionados, donde se accede a todos estos dispositivos desde espacio de usuario.</p>
<p>Comenzaremos ejecutando el script <code>./leds_test.py</code>. Si las conexiones se han realizado correctamente, el script encenderá y apagará alternativamente los tres LEDs de la placa Bee (D1, D2 y D3). La ejecución del script tendrá que cancelarse manualmente con CTRL+C, tras comprobar que los LEDs se apagan y enciencen alternativamente:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>pi@raspberrypi:~/TestBee<span class="w"> </span>$<span class="w"> </span>./leds_test.py
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>^CTraceback<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>recent<span class="w"> </span>call<span class="w"> </span>last<span class="o">)</span>:
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;/home/pi/TestBee/./leds_test.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">20</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;module&gt;
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span>time.sleep<span class="o">(</span><span class="m">0</span>.5<span class="o">)</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>KeyboardInterrupt
</span></code></pre></div>
<p>En segundo lugar probaremos el funcionamiento del pulsador SW1, que se encuentra debajo de los LEDs. El script <code>./button_test.py</code> muestra periodicamente el estado del circuito del pulsador SW1, imprimiendo "Closed" cuando el pulsador no esté pulsado, y "Open" al mantener presionado el pulsador. De nuevo, la ejecución del script ha de interrumpirse manualmente con CTRL+C al finalizar la prueba:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>pi@raspberrypi:~/TestBee<span class="w"> </span>$<span class="w"> </span>./button_test.py<span class="w"> </span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>Closed
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>Closed
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>Closed
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>Closed
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>Closed
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>Closed
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>Closed
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>Closed
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>Closed
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>Closed
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>Closed
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>Closed
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>Closed
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>Open
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>Open
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>Open
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>Open
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>Open
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>Open
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>Open
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>Open
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>Open
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>Closed
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>Closed
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>Closed
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>Closed
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>Open
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>Open
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>Open
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>Open
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>Open
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>Open
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>Closed
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>Closed
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>Closed
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a>Closed
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>Closed
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a>Closed
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>^CTraceback<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>recent<span class="w"> </span>call<span class="w"> </span>last<span class="o">)</span>:
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;/home/pi/TestBee/./button_test.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">17</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;module&gt;
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a><span class="w">    </span>time.sleep<span class="o">(</span><span class="m">0</span>.2<span class="o">)</span>
</span></code></pre></div>
<p>Probaremos ahora el display 7 segmentos mediante el script <code>7sdisplay_test.py</code>. Si las conexiones se han realizado correctamente, el script mostrará continuamente la secuencia hexadecimal de números 0,1,2,..., F. La ejecución del script tendrá que cancelarse tecleando CTRL+C:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>pi@raspberrypi:~/Code/TestBee<span class="w"> </span>$<span class="w"> </span>./7sdisplay_test.py<span class="w"> </span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="o">========================================</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="p">|</span><span class="w">           </span>LEDs<span class="w"> </span>with<span class="w"> </span>74HC595<span class="w">          </span><span class="p">|</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="p">|</span><span class="w">                                      </span><span class="p">|</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="p">|</span><span class="w">       </span>Control<span class="w"> </span>LEDs<span class="w"> </span>with<span class="w"> </span>74HC595<span class="w">      </span><span class="p">|</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="p">|</span><span class="w">                                      </span><span class="p">|</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="o">========================================</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>Program<span class="w"> </span>is<span class="w"> </span>running...
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>Please<span class="w"> </span>press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>end<span class="w"> </span>the<span class="w"> </span>program...
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>^Cpi@raspberrypi:~/Code/TestBee<span class="w"> </span>$<span class="w"> </span>
</span></code></pre></div>
<p>Finalmente, se comprobará el funcionamiento del <em>buzzer</em> pasivo, mediante el script <code>buzzer_test.sh</code>. Este script configura el <em>buzzer</em> para la reproducción de la siguiente secuencia de notas: LA4, MI4 y LA4 (cada una de ellas durante un segundo). Este script, a diferencia de los anteriores, ha de ejecutarse con <code>sudo</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>pi@raspberrypi:~/TestBee<span class="w"> </span>$<span class="w"> </span>sudo<span class="w"> </span>./buzzer_test.sh<span class="w"> </span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>Exporting<span class="w"> </span>PWM0<span class="w"> </span>channel
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>Testing<span class="w"> </span>Passive<span class="w"> </span>Buzzer
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>A4<span class="w"> </span>..<span class="w"> </span>E4<span class="w"> </span>..<span class="w"> </span>A4
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>Done
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>Unexporting<span class="w"> </span>PWM0<span class="w"> </span>channel
</span></code></pre></div>
<h2 id="analisis-de-alternativas-para-desarrollo-en-la-raspberry-pi-desde-la-maquina-virtual-configuracion-de-vscode">Análisis de alternativas para desarrollo en la Raspberry Pi desde la máquina virtual. Configuración de VSCode.<a class="headerlink" href="#analisis-de-alternativas-para-desarrollo-en-la-raspberry-pi-desde-la-maquina-virtual-configuracion-de-vscode" title="Permanent link">&para;</a></h2>
<p>Por motivos de rendimiento se aconseja almacenar en el directorio HOME del usuario <code>pi</code> --en la propia Raspberry Pi (tarjeta SD)-- los ficheros fuente de los módulos del kernel a desarrollar en las prácticas. También es recomendable hacer copia de seguridad de los ficheros cada cierto tiempo transfiriéndolos al sistema host  por red (p.ej., usando comando <code>scp</code> visto en clase). En este caso, usaremos el término "<em>host</em>" para referirnos a la máquina virtual de Debian, que es desde donde nos comunicaremos por red con la placa Raspberry Pi.</p>
<p>Conectarse a la placa por SSH desde la máquina virtual será algo muy frecuente durante la realización de las prácticas. Por este motivo, se aconseja configurar el acceso a la Raspberry Pi sin contraseña, es decir usando una clave SSH. Para establecer la configuración han de seguirse los siguientes pasos dentro de la máquina virtual:</p>
<ol>
<li>
<p>Si el fichero <code>~/.ssh/id_rsa.pub</code> no existe, ha de crearse uno mediante el comando <code>ssh-keygen -t rsa -b 2048</code>. En nuestro caso teclearemos ENTER a continuación para aceptar la ruta por defecto del fichero, y NO establecer <em>passphrase</em>: </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>kernel@debian:~$<span class="w"> </span>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-b<span class="w"> </span><span class="m">2048</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Generating<span class="w"> </span>public/private<span class="w"> </span>rsa<span class="w"> </span>key<span class="w"> </span>pair.
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Enter<span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>/home/kernel/.ssh/id_rsa<span class="o">)</span>:<span class="w"> </span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>Enter<span class="w"> </span>passphrase<span class="w"> </span><span class="o">(</span>empty<span class="w"> </span><span class="k">for</span><span class="w"> </span>no<span class="w"> </span>passphrase<span class="o">)</span>:<span class="w"> </span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>Enter<span class="w"> </span>same<span class="w"> </span>passphrase<span class="w"> </span>again:<span class="w"> </span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>Your<span class="w"> </span>identification<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>/home/kernel/.ssh/id_rsa.
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>Your<span class="w"> </span>public<span class="w"> </span>key<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>/home/kernel/.ssh/id_rsa.pub.
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>The<span class="w"> </span>key<span class="w"> </span>fingerprint<span class="w"> </span>is:
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>SHA256:6IdQ3RHxf8QeyZRmCgN1j2l7u5v/Dx18VPLjmxamRy8<span class="w"> </span>kernel@debian
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>The<span class="w"> </span>key<span class="err">&#39;</span>s<span class="w"> </span>randomart<span class="w"> </span>image<span class="w"> </span>is:
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>+---<span class="o">[</span>RSA<span class="w"> </span><span class="m">2048</span><span class="o">]</span>----+
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="p">|</span><span class="w">         </span>.*+<span class="w"> </span>...o<span class="p">|</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="p">|</span><span class="w">       </span>.<span class="w"> </span>.<span class="w"> </span><span class="o">=</span>.<span class="w"> </span>*Bo<span class="p">|</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="p">|</span><span class="w">      </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>+++*<span class="o">=</span><span class="p">|</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="p">|</span><span class="w">     </span>.<span class="w"> </span>.<span class="w">    </span>.o++o<span class="p">|</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="p">|</span><span class="w">    </span>.<span class="w"> </span>.<span class="w"> </span>S<span class="w">    </span>..O+<span class="p">|</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="p">|</span><span class="w">     </span>o<span class="w"> </span>.<span class="w">      </span><span class="o">=</span>oO<span class="p">|</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="p">|</span><span class="w">      </span>o<span class="w"> </span>.<span class="w">    </span>.E*o<span class="p">|</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="p">|</span><span class="w">       </span>.<span class="w">      </span>ooo<span class="p">|</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="p">|</span><span class="w">               </span>+O<span class="p">|</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</span></code></pre></div>
</li>
<li>
<p>Dar de alta la clave SSH generada en el registro del usuario <code>pi</code> dentro de la Raspberry Pi. Para ello haremos uso del comando <code>ssh-copy-id</code> como se muestra a continuación, y tecleando la contraseña del usuario (<code>raspberry</code>) cuando nos lo solicite:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>kernel@debian:~$<span class="w"> </span>ssh-copy-id<span class="w"> </span>pi@pi
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>/usr/bin/ssh-copy-id:<span class="w"> </span>INFO:<span class="w"> </span>attempting<span class="w"> </span>to<span class="w"> </span>log<span class="w"> </span><span class="k">in</span><span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>key<span class="o">(</span>s<span class="o">)</span>,<span class="w"> </span>to<span class="w"> </span>filter<span class="w"> </span>out<span class="w"> </span>any<span class="w"> </span>that<span class="w"> </span>are<span class="w"> </span>already<span class="w"> </span>installed
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>/usr/bin/ssh-copy-id:<span class="w"> </span>INFO:<span class="w"> </span><span class="m">1</span><span class="w"> </span>key<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>remain<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>installed<span class="w"> </span>--<span class="w"> </span><span class="k">if</span><span class="w"> </span>you<span class="w"> </span>are<span class="w"> </span>prompted<span class="w"> </span>now<span class="w"> </span>it<span class="w"> </span>is<span class="w"> </span>to<span class="w"> </span>install<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>keys
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>pi@pi<span class="s1">&#39;s password: </span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="s1">Number of key(s) added: 1</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="s1">Now try logging into the machine, with:   &quot;ssh &#39;</span>pi@pi<span class="err">&#39;</span><span class="s2">&quot;</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="s2">and check to make sure that only the key(s) you wanted were added.</span>
</span></code></pre></div>
</li>
<li>
<p>Llegados a este punto ya podremos conectarnos por SSH a la Raspberry Pi sin teclear la contraseña, y usando por debajo la clave SSH generada:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>kernel@debian:~$<span class="w"> </span>ssh<span class="w"> </span>pi@pi
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>Linux<span class="w"> </span>raspberrypi<span class="w"> </span><span class="m">5</span>.10.92-v7+<span class="w"> </span><span class="c1">#1514 SMP Mon Jan 17 17:36:39 GMT 2022 armv7l</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>The<span class="w"> </span>programs<span class="w"> </span>included<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>Debian<span class="w"> </span>GNU/Linux<span class="w"> </span>system<span class="w"> </span>are<span class="w"> </span>free<span class="w"> </span>software<span class="p">;</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>the<span class="w"> </span>exact<span class="w"> </span>distribution<span class="w"> </span>terms<span class="w"> </span><span class="k">for</span><span class="w"> </span>each<span class="w"> </span>program<span class="w"> </span>are<span class="w"> </span>described<span class="w"> </span><span class="k">in</span><span class="w"> </span>the
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>individual<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>/usr/share/doc/*/copyright.
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>Debian<span class="w"> </span>GNU/Linux<span class="w"> </span>comes<span class="w"> </span>with<span class="w"> </span>ABSOLUTELY<span class="w"> </span>NO<span class="w"> </span>WARRANTY,<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>extent
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>permitted<span class="w"> </span>by<span class="w"> </span>applicable<span class="w"> </span>law.
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>Last<span class="w"> </span>login:<span class="w"> </span>Sat<span class="w"> </span>Sep<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">18</span>:07:44<span class="w"> </span><span class="m">2022</span><span class="w"> </span>from<span class="w"> </span><span class="m">192</span>.168.2.1
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>SSH<span class="w"> </span>is<span class="w"> </span>enabled<span class="w"> </span>and<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;pi&#39;</span><span class="w"> </span>user<span class="w"> </span>has<span class="w"> </span>not<span class="w"> </span>been<span class="w"> </span>changed.
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>security<span class="w"> </span>risk<span class="w"> </span>-<span class="w"> </span>please<span class="w"> </span>login<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;pi&#39;</span><span class="w"> </span>user<span class="w"> </span>and<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;passwd&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>password.
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>Wi-Fi<span class="w"> </span>is<span class="w"> </span>currently<span class="w"> </span>blocked<span class="w"> </span>by<span class="w"> </span>rfkill.
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>Use<span class="w"> </span>raspi-config<span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>the<span class="w"> </span>country<span class="w"> </span>before<span class="w"> </span>use.
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>pi@raspberrypi:~<span class="w"> </span>$<span class="w"> </span>
</span></code></pre></div>
</li>
</ol>
<p>Existen esencialmente tres alternativas para desarrollar las prácticas sobre la Raspberry Pi, compilando los módulos del kernel desde la propia placa^[También es posible almacenar, editar los ficheros, y compilar los módulos desde el sistema <em>host</em>, empleando compilación cruzada. Sin embargo esto conlleva copiar los .ko correspondientes a la placa para testear su funcionalidad.]. A continuación se describen las distintas opciones.</p>
<h3 id="opcion-1-ejecucion-del-editor-en-la-propia-placa">Opción 1: Ejecución del editor en la propia placa<a class="headerlink" href="#opcion-1-ejecucion-del-editor-en-la-propia-placa" title="Permanent link">&para;</a></h3>
<p>Editar los ficheros con programa editor instalado en la propia placa, lanzando el editor por SSH. Pueden utilizarse para ello editores de línea de comandos (como <code>vim</code> o <code>nano</code>) o incluso editores gráficos como <code>geany</code> (esto exige activar la opción <code>-X</code> al conectarse por SSH: <code>ssh -X pi@pi</code>). La compilación debe llevarse a cabo desde un shell SSH dentro de la propia Raspberry Pi.</p>
<h3 id="opcion-2-sshfs-y-edicion-de-ficheros-desde-el-host">Opción 2: SSHFS y edición de ficheros desde el <em>host</em><a class="headerlink" href="#opcion-2-sshfs-y-edicion-de-ficheros-desde-el-host" title="Permanent link">&para;</a></h3>
<p>El sistema de ficheros de la Raspberry Pi se puede montar en el <em>host</em> (máquina virtual de Debian) por SSH usando el comando <code>sshfs</code>, como en el siguiente ejemplo:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>kernel@debian:~$ mkdir home-raspberry
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>kernel@debian:~$ sshfs pi@pi:/home/pi home-raspberry
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>kernel@debian:~$ ls home-raspberry/
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>Bookshelf  Desktop    Downloads   Pictures   Videos
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>Documents  Music      Public    Templates
</span></code></pre></div>
<p>En el ejemplo se crea un directorio vacío <code>home-raspberry</code> (puede usarse el nombre que se desee), que se emplea como punto de montaje. Gracias al comando <code>sshfs</code> del ejemplo se monta el directorio <code>HOME</code> del usuario <code>pi</code> de la Raspberry en el directorio <code>~/home-raspberry</code> del <em>host</em>. Una vez montada la carpeta por SSH se pueden editar los ficheros con cualquier editor en el host, ya sea por línea de comandos o gráficamente (p.ej., con Sublime Text o VSCode). SSHFS transfiere automáticamente los ficheros a la Raspberry cuando detecta cambios en los mismos, y sin requerir intervención del usuario. </p>
<p>Cuando se haya acabado de trabajar con los ficheros, o cuando se desee reiniciar o apagar la Raspberry Pi, se ha de desmontar la carpeta montada usando <code>fusermount</code>: </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>kernel@debian:~$<span class="w"> </span>fusermount<span class="w"> </span>-u<span class="w"> </span>home-raspberry
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>kernel@debian:~$<span class="w"> </span>
</span></code></pre></div>
<h3 id="opcion-3-uso-de-extension-remote-de-vscode-para-trabajar-con-raspberry-pi-de-forma-transparente">Opción 3: Uso de extensión <em>Remote</em> de VSCode para trabajar con Raspberry Pi de forma transparente<a class="headerlink" href="#opcion-3-uso-de-extension-remote-de-vscode-para-trabajar-con-raspberry-pi-de-forma-transparente" title="Permanent link">&para;</a></h3>
<p>VSCode posee una extensión llamada <em>Remote</em> que permite trabajar con una o varias carpetas de un sistema accesible por SSH^[Este <em>plugin</em> de VSCode también soporta trabajar con WSL y contenedores Docker.] como si de una carpeta local se tratara. Una vez se ha establecido la conexión de VSCode con el sistema remoto, los terminales abiertos dentro del propio entorno se ejecutarán en la máquina a la que nos hemos conectado. Por lo tanto, cada terminal se corresponde con un shell SSH en la máquina <em>target</em> (la Raspberry Pi en nuestro caso). En definitiva, de esta forma tendremos la ilusión de que trabajamos con VSCode desde dentro del propio sistema <em>target</em>, pero usando el entorno gráfico del <em>host</em> de desarrollo.</p>
<p>La extensión <em>Remote</em> ya está instalada en la máquina virtual del laboratorio. No obstante, hemos de configurar dicha extensión para trabajar con la Raspberry Pi. Para ilustrar el proceso de configuración de <em>Remote</em> desde la máquina virtual se proporciona el vídeo mostrado a continuación. En el vídeo se asume que se ha habilitado el acceso por SSH sin contraseña (vía clave SSH) a la Raspberry Pi siguiendo las instrucciones mostradas más arriba.</p>
<iframe src="https://drive.google.com/file/d/1rOSmB5T_ykGrL1aEHnFy2OjiLgomgwxa/preview" allowfullscreen="true" width="700" height="394"></iframe>
<p>Una vez que la Raspberry Pi se ha dado de alta como <em>remote</em> dentro de VSCode --como se ilustra en el vídeo--, dicho remote permanecerá registrado en futuras ejecuciones de VSCode. Por lo tanto, para trabajar con ficheros en la placa bastará abrir la carpeta deseada desde el explorador de <em>Remotes</em>.</p>
<p>Por último, se ha de tener presente que cuando hacemos uso de la extensión <em>Remote</em>, es necesario instalar las extensiones de VSCode que deseemos para desarrollar desde ese <em>target</em> al que nos conectamos. Para trabajar con la Raspberry Pi, se recomienda instalar las extensiones estándar de VSCode para desarollo C/C++. La instalación debe hacerse desde una ventana de Remote. </p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../robotica/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Prácticas de Robótica" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Prácticas de Robótica
            </div>
          </div>
        </a>
      
      
        
        <a href="../drivers/" class="md-footer__link md-footer__link--next" aria-label="Next: Drivers en Linux. Aspectos básicos y GPIO" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Drivers en Linux. Aspectos básicos y GPIO
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>